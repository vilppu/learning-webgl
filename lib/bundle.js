require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

var shaders = exports.shaders = {
  "default.vert": "/* default vertext shader */\r\n\r\nattribute vec3 aVertexPosition;\r\n\r\nuniform mat4 uMVMatrix;\r\nuniform mat4 uPMatrix;\r\n\r\nvoid main(void) {\r\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\r\n}",
  "default.frag": "/* default fragment shader */\r\n\r\nprecision mediump float;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\r\n}\r\n"
};

},{}],2:[function(require,module,exports){
"use strict";

/*global mat4:false */


var setupViewPortOf = exports.setupViewPortOf = function (gl) {
  gl.clearColor(0, 0, 0, 1);
  gl.enable(gl.DEPTH_TEST);
  gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);
};

var clearViewPortOf = exports.clearViewPortOf = function (gl) {
  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
};

// export const positionCameraTo = (positionVector) => {
//         return {
//         using: (gl) => {  
//         }
//     };
// };

// export const directCameraTo = (directionVector) => {
//         return {
//         using: (gl) => {  
//         }
//     };
// };

},{}],3:[function(require,module,exports){
"use strict";

/*global mat4:false */

var getWebGLRenderingContextOf = exports.getWebGLRenderingContextOf = function (canvas) {
  var glOptions = { antialias: true };
  var gl = canvas.getContext("webgl", glOptions);

  if (!gl) {
    canvas.getContext("experimental-webgl", glOptions);
  }

  if (!gl) {
    throw "WebGL is not supported";
  }

  gl.projectionMatrix = mat4.create();
  gl.modelViewMatrix = mat4.create();
  mat4.perspective(gl.projectionMatrix, 45, gl.canvas.width / gl.canvas.height, 0.1, 100);

  return gl;
};

},{}],4:[function(require,module,exports){
"use strict";

/*
    .vert vertex shader
    .tesc tessellation control shader
    .tese tessellation evaluation shader
    .geom geometry shader
    .frag fragment shader
    .comp compute shader
*/
var shaders = require("../lib/shaders.js").shaders;


var validateThatShaderWasCompiledSuccessfully = function (gl, shader, shaderName) {
  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
    var lastError = gl.getShaderInfoLog(shader);
    gl.deleteShader(shader);
    throw "Failed to compile shader " + shaderName + ":" + lastError;
  }
};

var validateThatProgramWasLinkedSuccessfully = function (gl, shaderProgram) {
  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {
    var lastError = gl.getProgramInfoLog(shaderProgram);
    gl.deleteProgram(shaderProgram);
    throw "Failed to link shader program:" + lastError;
  }
};

var loadShaderFromLibrary = function (shaderName) {
  return {
    using: function (gl) {
      var shaderSource = shaders[shaderName];
      var shaderType = shaderName.indexOf("frag") !== -1 ? gl.FRAGMENT_SHADER : gl.VERTEX_SHADER;
      var shader = gl.createShader(shaderType);

      gl.shaderSource(shader, shaderSource);
      gl.compileShader(shader);
      validateThatShaderWasCompiledSuccessfully(gl, shader, shaderName);

      return shader;
    }
  };
};

var loadShader = function (shaderName) {
  return {
    to: function (shaderProgram) {
      return {
        using: function (gl) {
          var shader = loadShaderFromLibrary(shaderName).using(gl);

          gl.attachShader(shaderProgram, shader);
          gl.deleteShader(shader);

          return shader;
        }
      };
    }
  };
};

var getUniform = exports.getUniform = function (uniformName) {
  return {
    of: function (shaderProgram) {
      return {
        using: function (gl) {
          shaderProgram.uniforms = shaderProgram.uniforms || [];
          shaderProgram.uniforms[uniformName] = shaderProgram.uniforms[uniformName] || gl.getUniformLocation(shaderProgram, uniformName);

          return shaderProgram.uniforms[uniformName];
        }
      };
    }
  };
};

var loadShaderProgram = exports.loadShaderProgram = function (shaderNames) {
  return {
    to: function (gl) {
      var shaderProgram = gl.createProgram();

      for (var _iterator = shaderNames[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {
        var shaderName = _step.value;
        loadShader(shaderName).to(shaderProgram).using(gl);
      }

      gl.linkProgram(shaderProgram);
      validateThatProgramWasLinkedSuccessfully(gl, shaderProgram);

      gl.useProgram(shaderProgram);
      shaderProgram.vertexPositionAttribute = gl.getAttribLocation(shaderProgram, "aVertexPosition");
      gl.enableVertexAttribArray(shaderProgram.vertexPositionAttribute);

      shaderProgram.pMatrixUniform = gl.getUniformLocation(shaderProgram, "uPMatrix");
      shaderProgram.mvMatrixUniform = gl.getUniformLocation(shaderProgram, "uMVMatrix");

      return shaderProgram;
    }
  };
};

},{"../lib/shaders.js":1}],5:[function(require,module,exports){
"use strict";

/*global mat4:false */
var loadShaderProgram = require("./gl-shaders").loadShaderProgram;
var getTriangleMeshFrom = exports.getTriangleMeshFrom = function (triangleMeshSource) {
  return {
    using: function (webGLRenderingContext) {
      var gl = webGLRenderingContext;

      var verterBufferFrom = function (vertices) {
        var vertexBuffer = gl.createBuffer();

        gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);
        vertexBuffer.itemSize = 3;
        vertexBuffer.numItems = 3;

        return vertexBuffer;
      };

      var shaderProgramFrom = function (shaderNames) {
        return loadShaderProgram(shaderNames).to(gl);
      };

      return {
        vertexBuffer: verterBufferFrom(triangleMeshSource.vertices),
        shaderProgram: shaderProgramFrom(triangleMeshSource.shaderNames)
      };
    }
  };
};

var render = exports.render = function (triangleMesh) {
  return {
    to: function (webGLRenderingContext) {
      var gl = webGLRenderingContext;
      var shaderProgram = triangleMesh.shaderProgram;

      var setMatrixUniforms = function () {
        gl.uniformMatrix4fv(shaderProgram.pMatrixUniform, false, gl.projectionMatrix);
        gl.uniformMatrix4fv(shaderProgram.mvMatrixUniform, false, gl.modelViewMatrix);
      };

      mat4.identity(gl.modelViewMatrix);
      mat4.translate(gl.modelViewMatrix, gl.modelViewMatrix, [0, 0, -1.8]);
      gl.bindBuffer(gl.ARRAY_BUFFER, triangleMesh.vertexBuffer);
      gl.vertexAttribPointer(shaderProgram.vertexPositionAttribute, triangleMesh.vertexBuffer.itemSize, gl.FLOAT, false, 0, 0);
      setMatrixUniforms();
      gl.drawArrays(gl.TRIANGLES, 0, triangleMesh.vertexBuffer.numItems);
    }
  };
};

},{"./gl-shaders":4}],"application":[function(require,module,exports){
"use strict";

var getWebGLRenderingContextOf = require("./gl-context").getWebGLRenderingContextOf;
var setupViewPortOf = require("./gl-camera").setupViewPortOf;
var clearViewPortOf = require("./gl-camera").clearViewPortOf;
var getTriangleMeshFrom = require("./gl-triangle-mesh").getTriangleMeshFrom;
var render = require("./gl-triangle-mesh").render;
var startOn = exports.startOn = function (canvas) {
  var triangleVertices = [0, 1, 0, -1, -1, 0, 1, -1, 0];

  var gl = getWebGLRenderingContextOf(canvas);

  var triangleSource = {
    vertices: triangleVertices,
    shaderNames: ["default.frag", "default.vert"]
  };

  var triangle = getTriangleMeshFrom(triangleSource).using(gl);

  var resizeCanvasToFitWindow = function () {
    setupViewPortOf(gl);
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  };

  var animationLoop = function () {
    resizeCanvasToFitWindow();

    clearViewPortOf(gl);
    render(triangle).to(gl);
    window.requestAnimationFrame(animationLoop);
  };

  animationLoop();
};

},{"./gl-camera":2,"./gl-context":3,"./gl-triangle-mesh":5}]},{},[])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXEFwcERhdGFcXFJvYW1pbmdcXG5wbVxcbm9kZV9tb2R1bGVzXFxicm93c2VyaWZ5XFxub2RlX21vZHVsZXNcXGJyb3dzZXItcGFja1xcX3ByZWx1ZGUuanMiLCJDOi9Vc2Vycy90aW1vdl8wMDAvRG9jdW1lbnRzL0dpdEh1Yi9sZWFybmluZy13ZWJnbC9saWIvc2hhZGVycy5qcyIsIkM6L1VzZXJzL3RpbW92XzAwMC9Eb2N1bWVudHMvR2l0SHViL2xlYXJuaW5nLXdlYmdsL3NyYy9nbC1jYW1lcmEuanMiLCJDOi9Vc2Vycy90aW1vdl8wMDAvRG9jdW1lbnRzL0dpdEh1Yi9sZWFybmluZy13ZWJnbC9zcmMvZ2wtY29udGV4dC5qcyIsIkM6L1VzZXJzL3RpbW92XzAwMC9Eb2N1bWVudHMvR2l0SHViL2xlYXJuaW5nLXdlYmdsL3NyYy9nbC1zaGFkZXJzLmpzIiwiQzovVXNlcnMvdGltb3ZfMDAwL0RvY3VtZW50cy9HaXRIdWIvbGVhcm5pbmctd2ViZ2wvc3JjL2dsLXRyaWFuZ2xlLW1lc2guanMiLCJDOi9Vc2Vycy90aW1vdl8wMDAvRG9jdW1lbnRzL0dpdEh1Yi9sZWFybmluZy13ZWJnbC9zcmMvYXBwbGljYXRpb24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FPLElBQU0sT0FBTyxXQUFQLE9BQU8sR0FDcEI7QUFDSSxnQkFBYyxFQUFFLG9PQUFvTztBQUNwUCxnQkFBYyxFQUFFLGlKQUFpSjtDQUNwSyxDQUNBOzs7Ozs7OztBQ0ZNLElBQU0sZUFBZSxXQUFmLGVBQWUsR0FBRyxVQUFDLEVBQUUsRUFBSztBQUNuQyxJQUFFLENBQUMsVUFBVSxDQUFDLENBQUcsRUFBRSxDQUFHLEVBQUUsQ0FBRyxFQUFFLENBQUcsQ0FBQyxDQUFDO0FBQ2xDLElBQUUsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3pCLElBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFF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LEdBQUcsMEJBQTBCLENBQUMsTUFBTSxDQUFDLENBQUM7O0FBRTlDLE1BQU0sY0FBYyxHQUFHO0FBQ25CLFlBQVEsRUFBRSxnQkFBZ0I7QUFDMUIsZUFBVyxFQUFFLENBQUMsY0FBYyxFQUFFLGNBQWMsQ0FBQztHQUNoRCxDQUFDOztBQUVGLE1BQU0sUUFBUSxHQUFHLG1CQUFtQixDQUFDLGNBQWMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQzs7QUFFL0QsTUFBTSx1QkFBdUIsR0FBRyxZQUFNO0FBQ2xDLG1CQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDcEIsVUFBTSxDQUFDLEtBQUssR0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDO0FBQy9CLFVBQU0sQ0FBQyxNQUFNLEdBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQztHQUNwQyxDQUFDOztBQUVGLE1BQU0sYUFBYSxHQUFHLFlBQU07QUFDeEIsMkJBQXVCLEVBQUUsQ0FBQzs7QUFFMUIsbUJBQWUsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNwQixVQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3hCLFVBQU0sQ0FBQyxxQkFBcUIsQ0FBQyxhQUFhLENBQUMsQ0FBQztHQUMvQyxDQUFDOztBQUVGLGVBQWEsRUFBRSxDQUFDO0NBQ25CLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiZXhwb3J0IGNvbnN0IHNoYWRlcnMgPSBcbntcbiAgICBcImRlZmF1bHQudmVydFwiOiBcIi8qIGRlZmF1bHQgdmVydGV4dCBzaGFkZXIgKi9cXHJcXG5cXHJcXG5hdHRyaWJ1dGUgdmVjMyBhVmVydGV4UG9zaXRpb247XFxyXFxuXFxyXFxudW5pZm9ybSBtYXQ0IHVNVk1hdHJpeDtcXHJcXG51bmlmb3JtIG1hdDQgdVBNYXRyaXg7XFxyXFxuXFxyXFxudm9pZCBtYWluKHZvaWQpIHtcXHJcXG4gICAgZ2xfUG9zaXRpb24gPSB1UE1hdHJpeCAqIHVNVk1hdHJpeCAqIHZlYzQoYVZlcnRleFBvc2l0aW9uLCAxLjApO1xcclxcbn1cIixcbiAgICBcImRlZmF1bHQuZnJhZ1wiOiBcIi8qIGRlZmF1bHQgZnJhZ21lbnQgc2hhZGVyICovXFxyXFxuXFxyXFxucHJlY2lzaW9uIG1lZGl1bXAgZmxvYXQ7XFxyXFxuXFxyXFxudm9pZCBtYWluKHZvaWQpIHtcXHJcXG4gICAgZ2xfRnJhZ0NvbG9yID0gdmVjNCgxLjAsIDEuMCwgMS4wLCAxLjApO1xcclxcbn1cXHJcXG5cIlxufVxuO1xuIiwiLypnbG9iYWwgbWF0NDpmYWxzZSAqL1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBzZXR1cFZpZXdQb3J0T2YgPSAoZ2wpID0+IHtcclxuICAgIGdsLmNsZWFyQ29sb3IoMC4wLCAwLjAsIDAuMCwgMS4wKTtcclxuICAgIGdsLmVuYWJsZShnbC5ERVBUSF9URVNUKTsgICAgXHJcbiAgICBnbC52aWV3cG9ydCgwLCAwLCBnbC5jYW52YXMud2lkdGgsIGdsLmNhbnZhcy5oZWlnaHQpO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNsZWFyVmlld1BvcnRPZiA9IChnbCkgPT4ge1xyXG4gICAgZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCB8IGdsLkRFUFRIX0JVRkZFUl9CSVQpO1xyXG59O1xyXG5cclxuLy8gZXhwb3J0IGNvbnN0IHBvc2l0aW9uQ2FtZXJhVG8gPSAocG9zaXRpb25WZWN0b3IpID0+IHtcclxuLy8gICAgICAgICByZXR1cm4ge1xyXG4vLyAgICAgICAgIHVzaW5nOiAoZ2wpID0+IHsgICBcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9O1xyXG4vLyB9O1xyXG5cclxuLy8gZXhwb3J0IGNvbnN0IGRpcmVjdENhbWVyYVRvID0gKGRpcmVjdGlvblZlY3RvcikgPT4ge1xyXG4vLyAgICAgICAgIHJldHVybiB7XHJcbi8vICAgICAgICAgdXNpbmc6IChnbCkgPT4geyAgIFxyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH07XHJcbi8vIH07XHJcbiIsIi8qZ2xvYmFsIG1hdDQ6ZmFsc2UgKi9cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRXZWJHTFJlbmRlcmluZ0NvbnRleHRPZiA9IChjYW52YXMpID0+IHtcclxuICAgIGNvbnN0IGdsT3B0aW9ucyA9IHsgYW50aWFsaWFzOiB0cnVlIH07XHJcbiAgICBsZXQgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dChcIndlYmdsXCIsIGdsT3B0aW9ucyk7XHJcblxyXG4gICAgaWYoIWdsKSB7XHJcbiAgICAgICAgY2FudmFzLmdldENvbnRleHQoXCJleHBlcmltZW50YWwtd2ViZ2xcIiwgZ2xPcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICBpZighZ2wpIHtcclxuICAgICAgICB0aHJvdyBcIldlYkdMIGlzIG5vdCBzdXBwb3J0ZWRcIjtcclxuICAgIH1cclxuXHJcbiAgICBnbC5wcm9qZWN0aW9uTWF0cml4ID0gbWF0NC5jcmVhdGUoKTtcclxuICAgIGdsLm1vZGVsVmlld01hdHJpeCA9IG1hdDQuY3JlYXRlKCk7XHJcbiAgICBtYXQ0LnBlcnNwZWN0aXZlKGdsLnByb2plY3Rpb25NYXRyaXgsIDQ1LCBnbC5jYW52YXMud2lkdGggLyBnbC5jYW52YXMuaGVpZ2h0LCAwLjEsIDEwMC4wKTtcclxuXHJcbiAgICByZXR1cm4gZ2w7XHJcbn07XHJcbiIsIi8qXHJcbiAgICAudmVydCB2ZXJ0ZXggc2hhZGVyXHJcbiAgICAudGVzYyB0ZXNzZWxsYXRpb24gY29udHJvbCBzaGFkZXJcclxuICAgIC50ZXNlIHRlc3NlbGxhdGlvbiBldmFsdWF0aW9uIHNoYWRlclxyXG4gICAgLmdlb20gZ2VvbWV0cnkgc2hhZGVyXHJcbiAgICAuZnJhZyBmcmFnbWVudCBzaGFkZXJcclxuICAgIC5jb21wIGNvbXB1dGUgc2hhZGVyXHJcbiovXHJcbmltcG9ydCB7IHNoYWRlcnMgfSBmcm9tICcuLi9saWIvc2hhZGVycy5qcyc7XHJcblxyXG5jb25zdCB2YWxpZGF0ZVRoYXRTaGFkZXJXYXNDb21waWxlZFN1Y2Nlc3NmdWxseSA9IChnbCwgc2hhZGVyLCBzaGFkZXJOYW1lKSA9PiB7XHJcbiAgICBpZiAoIWdsLmdldFNoYWRlclBhcmFtZXRlcihzaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSkge1xyXG4gICAgICAgIHZhciBsYXN0RXJyb3IgPSBnbC5nZXRTaGFkZXJJbmZvTG9nKHNoYWRlcik7XHJcbiAgICAgICAgZ2wuZGVsZXRlU2hhZGVyKHNoYWRlcik7XHJcbiAgICAgICAgdGhyb3cgJ0ZhaWxlZCB0byBjb21waWxlIHNoYWRlciAnICsgc2hhZGVyTmFtZSArICc6JyArIGxhc3RFcnJvcjtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IHZhbGlkYXRlVGhhdFByb2dyYW1XYXNMaW5rZWRTdWNjZXNzZnVsbHkgPSAoZ2wsIHNoYWRlclByb2dyYW0pID0+IHtcclxuICAgIGlmICghZ2wuZ2V0UHJvZ3JhbVBhcmFtZXRlcihzaGFkZXJQcm9ncmFtLCBnbC5MSU5LX1NUQVRVUykpIHtcclxuICAgICAgICB2YXIgbGFzdEVycm9yID0gZ2wuZ2V0UHJvZ3JhbUluZm9Mb2coc2hhZGVyUHJvZ3JhbSk7XHJcbiAgICAgICAgZ2wuZGVsZXRlUHJvZ3JhbShzaGFkZXJQcm9ncmFtKTtcclxuICAgICAgICB0aHJvdyAnRmFpbGVkIHRvIGxpbmsgc2hhZGVyIHByb2dyYW06JyArIGxhc3RFcnJvcjtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IGxvYWRTaGFkZXJGcm9tTGlicmFyeSA9IChzaGFkZXJOYW1lKSA9PiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHVzaW5nOiAoZ2wpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgc2hhZGVyU291cmNlID0gc2hhZGVyc1tzaGFkZXJOYW1lXTtcclxuICAgICAgICAgICAgY29uc3Qgc2hhZGVyVHlwZSA9IHNoYWRlck5hbWUuaW5kZXhPZignZnJhZycpICE9PSAtMSA/IGdsLkZSQUdNRU5UX1NIQURFUiA6IGdsLlZFUlRFWF9TSEFERVI7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoYWRlciA9IGdsLmNyZWF0ZVNoYWRlcihzaGFkZXJUeXBlKTtcclxuXHJcbiAgICAgICAgICAgIGdsLnNoYWRlclNvdXJjZShzaGFkZXIsIHNoYWRlclNvdXJjZSk7XHJcbiAgICAgICAgICAgIGdsLmNvbXBpbGVTaGFkZXIoc2hhZGVyKTtcclxuICAgICAgICAgICAgdmFsaWRhdGVUaGF0U2hhZGVyV2FzQ29tcGlsZWRTdWNjZXNzZnVsbHkoZ2wsIHNoYWRlciwgc2hhZGVyTmFtZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gc2hhZGVyO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XHJcblxyXG5jb25zdCBsb2FkU2hhZGVyID0gKHNoYWRlck5hbWUpID0+IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdG86IChzaGFkZXJQcm9ncmFtKSA9PntcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHVzaW5nOiAoZ2wpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc2hhZGVyID0gbG9hZFNoYWRlckZyb21MaWJyYXJ5KHNoYWRlck5hbWUpLnVzaW5nKGdsKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBnbC5hdHRhY2hTaGFkZXIoc2hhZGVyUHJvZ3JhbSwgc2hhZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICBnbC5kZWxldGVTaGFkZXIoc2hhZGVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNoYWRlcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFVuaWZvcm0gPSAodW5pZm9ybU5hbWUpID0+IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgb2Y6IChzaGFkZXJQcm9ncmFtKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB1c2luZzogKGdsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2hhZGVyUHJvZ3JhbS51bmlmb3JtcyA9IHNoYWRlclByb2dyYW0udW5pZm9ybXMgfHwgW107XHJcbiAgICAgICAgICAgICAgICAgICAgc2hhZGVyUHJvZ3JhbS51bmlmb3Jtc1t1bmlmb3JtTmFtZV0gPSBzaGFkZXJQcm9ncmFtLnVuaWZvcm1zW3VuaWZvcm1OYW1lXSB8fCBnbC5nZXRVbmlmb3JtTG9jYXRpb24oc2hhZGVyUHJvZ3JhbSwgdW5pZm9ybU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hhZGVyUHJvZ3JhbS51bmlmb3Jtc1t1bmlmb3JtTmFtZV07ICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGxvYWRTaGFkZXJQcm9ncmFtID0gKHNoYWRlck5hbWVzKSA9PiB7XHJcbiAgICByZXR1cm4gIHtcclxuICAgICAgICB0bzogKGdsKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoYWRlclByb2dyYW0gPSBnbC5jcmVhdGVQcm9ncmFtKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKHZhciBzaGFkZXJOYW1lIG9mIHNoYWRlck5hbWVzKSB7XHJcbiAgICAgICAgICAgICAgICBsb2FkU2hhZGVyKHNoYWRlck5hbWUpLnRvKHNoYWRlclByb2dyYW0pLnVzaW5nKGdsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZ2wubGlua1Byb2dyYW0oc2hhZGVyUHJvZ3JhbSk7XHJcbiAgICAgICAgICAgIHZhbGlkYXRlVGhhdFByb2dyYW1XYXNMaW5rZWRTdWNjZXNzZnVsbHkoZ2wsIHNoYWRlclByb2dyYW0pO1xyXG5cclxuICAgICAgICAgICAgZ2wudXNlUHJvZ3JhbShzaGFkZXJQcm9ncmFtKTtcclxuICAgICAgICAgICAgc2hhZGVyUHJvZ3JhbS52ZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZSA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHNoYWRlclByb2dyYW0sICdhVmVydGV4UG9zaXRpb24nKTtcclxuICAgICAgICAgICAgZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoc2hhZGVyUHJvZ3JhbS52ZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZSk7XHJcblxyXG4gICAgICAgICAgICBzaGFkZXJQcm9ncmFtLnBNYXRyaXhVbmlmb3JtID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHNoYWRlclByb2dyYW0sICd1UE1hdHJpeCcpO1xyXG4gICAgICAgICAgICBzaGFkZXJQcm9ncmFtLm12TWF0cml4VW5pZm9ybSA9IGdsLmdldFVuaWZvcm1Mb2NhdGlvbihzaGFkZXJQcm9ncmFtLCAndU1WTWF0cml4Jyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc2hhZGVyUHJvZ3JhbTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xyXG4iLCIvKmdsb2JhbCBtYXQ0OmZhbHNlICovXHJcbmltcG9ydCAgeyBsb2FkU2hhZGVyUHJvZ3JhbSB9IGZyb20gJy4vZ2wtc2hhZGVycyc7XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VHJpYW5nbGVNZXNoRnJvbSA9ICh0cmlhbmdsZU1lc2hTb3VyY2UpID0+IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdXNpbmc6ICh3ZWJHTFJlbmRlcmluZ0NvbnRleHQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZ2wgPSB3ZWJHTFJlbmRlcmluZ0NvbnRleHQ7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB2ZXJ0ZXJCdWZmZXJGcm9tID0gKHZlcnRpY2VzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2ZXJ0ZXhCdWZmZXIgPSBnbC5jcmVhdGVCdWZmZXIoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgdmVydGV4QnVmZmVyKTtcclxuICAgICAgICAgICAgICAgIGdsLmJ1ZmZlckRhdGEoZ2wuQVJSQVlfQlVGRkVSLCBuZXcgRmxvYXQzMkFycmF5KHZlcnRpY2VzKSwgZ2wuU1RBVElDX0RSQVcpO1xyXG4gICAgICAgICAgICAgICAgdmVydGV4QnVmZmVyLml0ZW1TaXplID0gMztcclxuICAgICAgICAgICAgICAgIHZlcnRleEJ1ZmZlci5udW1JdGVtcyA9IDM7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZlcnRleEJ1ZmZlcjtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHNoYWRlclByb2dyYW1Gcm9tID0gKHNoYWRlck5hbWVzKSA9PiB7IFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRTaGFkZXJQcm9ncmFtKHNoYWRlck5hbWVzKS50byhnbCk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdmVydGV4QnVmZmVyOiB2ZXJ0ZXJCdWZmZXJGcm9tKHRyaWFuZ2xlTWVzaFNvdXJjZS52ZXJ0aWNlcyksXHJcbiAgICAgICAgICAgICAgICBzaGFkZXJQcm9ncmFtOiBzaGFkZXJQcm9ncmFtRnJvbSh0cmlhbmdsZU1lc2hTb3VyY2Uuc2hhZGVyTmFtZXMpXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZW5kZXIgPSAodHJpYW5nbGVNZXNoKSA9PiB7ICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICB0bzogKHdlYkdMUmVuZGVyaW5nQ29udGV4dCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBnbCA9IHdlYkdMUmVuZGVyaW5nQ29udGV4dDtcclxuICAgICAgICAgICAgY29uc3Qgc2hhZGVyUHJvZ3JhbSA9IHRyaWFuZ2xlTWVzaC5zaGFkZXJQcm9ncmFtO1xyXG5cclxuICAgICAgICAgICAgY29uc3Qgc2V0TWF0cml4VW5pZm9ybXMgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBnbC51bmlmb3JtTWF0cml4NGZ2KHNoYWRlclByb2dyYW0ucE1hdHJpeFVuaWZvcm0sIGZhbHNlLCBnbC5wcm9qZWN0aW9uTWF0cml4KTtcclxuICAgICAgICAgICAgICAgIGdsLnVuaWZvcm1NYXRyaXg0ZnYoc2hhZGVyUHJvZ3JhbS5tdk1hdHJpeFVuaWZvcm0sIGZhbHNlLCBnbC5tb2RlbFZpZXdNYXRyaXgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgbWF0NC5pZGVudGl0eShnbC5tb2RlbFZpZXdNYXRyaXgpO1xyXG4gICAgICAgICAgICBtYXQ0LnRyYW5zbGF0ZShnbC5tb2RlbFZpZXdNYXRyaXgsIGdsLm1vZGVsVmlld01hdHJpeCwgWzAsIDAuMCwgLTEuOF0pO1xyXG4gICAgICAgICAgICBnbC5iaW5kQnVmZmVyKGdsLkFSUkFZX0JVRkZFUiwgdHJpYW5nbGVNZXNoLnZlcnRleEJ1ZmZlcik7XHJcbiAgICAgICAgICAgIGdsLnZlcnRleEF0dHJpYlBvaW50ZXIoc2hhZGVyUHJvZ3JhbS52ZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZSwgdHJpYW5nbGVNZXNoLnZlcnRleEJ1ZmZlci5pdGVtU2l6ZSwgZ2wuRkxPQVQsIGZhbHNlLCAwLCAwKTtcclxuICAgICAgICAgICAgc2V0TWF0cml4VW5pZm9ybXMoKTtcclxuICAgICAgICAgICAgZ2wuZHJhd0FycmF5cyhnbC5UUklBTkdMRVMsIDAsIHRyaWFuZ2xlTWVzaC52ZXJ0ZXhCdWZmZXIubnVtSXRlbXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XHJcbiIsImltcG9ydCAgeyBnZXRXZWJHTFJlbmRlcmluZ0NvbnRleHRPZiB9IGZyb20gJy4vZ2wtY29udGV4dCc7XHJcbmltcG9ydCAgeyBzZXR1cFZpZXdQb3J0T2YsIGNsZWFyVmlld1BvcnRPZiwgIH0gZnJvbSAnLi9nbC1jYW1lcmEnO1xyXG5pbXBvcnQgIHsgZ2V0VHJpYW5nbGVNZXNoRnJvbSwgcmVuZGVyICB9IGZyb20gJy4vZ2wtdHJpYW5nbGUtbWVzaCc7XHJcblxyXG5cclxuZXhwb3J0IGNvbnN0IHN0YXJ0T24gPSAoY2FudmFzKSA9PiB7XHJcblxyXG4gICAgY29uc3QgdHJpYW5nbGVWZXJ0aWNlcyA9IFtcclxuICAgICAgICAwLjAsICAxLjAsICAwLjAsXHJcbiAgICAgICAgLTEuMCwgLTEuMCwgIDAuMCxcclxuICAgICAgICAxLjAsIC0xLjAsICAwLjBcclxuICAgIF07XHJcblxyXG4gICAgY29uc3QgZ2wgPSBnZXRXZWJHTFJlbmRlcmluZ0NvbnRleHRPZihjYW52YXMpO1xyXG5cclxuICAgIGNvbnN0IHRyaWFuZ2xlU291cmNlID0geyAgICAgICAgXHJcbiAgICAgICAgdmVydGljZXM6IHRyaWFuZ2xlVmVydGljZXMsXHJcbiAgICAgICAgc2hhZGVyTmFtZXM6IFsnZGVmYXVsdC5mcmFnJywgJ2RlZmF1bHQudmVydCddXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHRyaWFuZ2xlID0gZ2V0VHJpYW5nbGVNZXNoRnJvbSh0cmlhbmdsZVNvdXJjZSkudXNpbmcoZ2wpO1xyXG5cclxuICAgIGNvbnN0IHJlc2l6ZUNhbnZhc1RvRml0V2luZG93ID0gKCkgPT4ge1xyXG4gICAgICAgIHNldHVwVmlld1BvcnRPZihnbCk7XHJcbiAgICAgICAgY2FudmFzLndpZHRoPXdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQ9d2luZG93LmlubmVySGVpZ2h0O1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBhbmltYXRpb25Mb29wID0gKCkgPT4ge1xyXG4gICAgICAgIHJlc2l6ZUNhbnZhc1RvRml0V2luZG93KCk7XHJcblxyXG4gICAgICAgIGNsZWFyVmlld1BvcnRPZihnbCk7XHJcbiAgICAgICAgcmVuZGVyKHRyaWFuZ2xlKS50byhnbCk7XHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRpb25Mb29wKTtcclxuICAgIH07XHJcblxyXG4gICAgYW5pbWF0aW9uTG9vcCgpO1xyXG59O1xyXG4iXX0=
